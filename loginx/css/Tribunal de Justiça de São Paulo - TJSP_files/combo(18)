YUI.add("photo-lite-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{update:e.PhotoModelHelper.updateEngagement},toggleFave:e.PhotoModelHelper.toggleFave,addAsFave:e.PhotoModelHelper.addAsFave,getLargestSize:e.PhotoModelHelper.getLargestSize,getSizeToFit:e.PhotoModelHelper.getSizeToFit,getSizeIfExact:e.PhotoModelHelper.getSizeIfExact,isSizeSquare:e.PhotoModelHelper.isSizeSquare,isPhotoSquare:e.PhotoModelHelper.isPhotoSquare,attributes:{owner:{readOnly:!0,isModel:!0,getter:function(e,t){var n=this;return{id:n.getValue(t,"ownerNsid"),getValue:function(e){return e==="id"?n.getValue(t,"ownerNsid"):e==="nsid"?n.getValue(t,"ownerNsid"):e==="url"?n.getValue(t,"ownerUrl"):n.getValue(t,e)},toJSON:function(){return{id:n.getValue(t,"ownerNsid"),url:n.getValue(t,"ownerUrl"),pathAlias:n.getValue(t,"pathAlias"),username:n.getValue(t,"username"),realname:n.getValue(t,"realname"),displayname:n.getValue(t,"displayname"),nsid:n.getValue(t,"ownerNsid"),ownerUrl:n.getValue(t,"ownerUrl"),isMe:n.getValue(t,"isMe")}},exists:function(e){return!1}}}},pathAlias:e.PersonModelHelper.attributes.pathAlias,username:e.PersonModelHelper.attributes.username,realname:e.PersonModelHelper.attributes.realname,displayname:e.PersonModelHelper.attributes.displayname,nsid:e.PersonModelHelper.attributes.nsid,ownerUrl:e.PersonModelHelper.attributes.url,isMe:e.PersonModelHelper.attributes.isMe,engagement:{readOnly:!0,isModel:!0,getter:function(e,t){var n=this;return{getValue:function(e){return n.getValue(t,e)},toJSON:function(){return{ownerNsid:n.getValue(t,"ownerNsid"),isFaved:n.getValue(t,"isFaved"),faveCount:n.getValue(t,"faveCount"),commentCount:n.getValue(t,"commentCount"),canFave:n.getValue(t,"canFave")}},exists:function(e){return!1}}}},curation:{readOnly:!0,isModel:!0,getter:function(e,t){var n=this;return{getValue:function(e){return n.getValue(t,e)},toJSON:function(){return{is3MP:n.getValue(t,"is3MP"),ownerCountryApproved:n.getValue(t,"ownerCountryApproved"),ownerFollowedByCurators:n.getValue(t,"ownerFollowedByCurators"),ownerAdded:n.getValue(t,"ownerAdded"),ownerPassedOver:n.getValue(t,"ownerPassedOver"),statusColor:n.getValue(t,"statusColor")}},exists:function(e){return!1}}}},ownerNsid:e.PhotoModelHelper.attributes.ownerNsid,isFaved:e.PhotoModelHelper.attributes.isFaved,faveCount:e.PhotoModelHelper.attributes.faveCount,commentCount:e.PhotoModelHelper.attributes.commentCount,canFave:e.PhotoModelHelper.attributes.canFave,is3MP:e.PhotoModelHelper.attributes.is3MP,ownerCountryApproved:e.PhotoModelHelper.attributes.ownerCountryApproved,ownerFollowedByCurators:e.PhotoModelHelper.attributes.ownerFollowedByCurators,ownerAdded:e.PhotoModelHelper.attributes.ownerAdded,ownerPassedOver:e.PhotoModelHelper.attributes.ownerPassedOver,statusColor:e.PhotoModelHelper.attributes.statusColor,title:e.PhotoModelHelper.attributes.title,description:e.PhotoModelHelper.attributes.description,mediaType:e.PhotoModelHelper.attributes.mediaType,license:e.PhotoModelHelper.attributes.license,isVideo:e.PhotoModelHelper.attributes.isVideo,isOwner:e.PhotoModelHelper.attributes.isOwner,sizes:e.PhotoModelHelper.attributes.sizes,descendingSizes:e.PhotoModelHelper.attributes.descendingSizes,ascendingSizes:e.PhotoModelHelper.attributes.ascendingSizes,aspectRatio:e.PhotoModelHelper.attributes.aspectRatio,needsInterstitial:e.PhotoModelHelper.attributes.needsInterstitial,canComment:e.PhotoModelHelper.attributes.canComment,url:e.PhotoModelHelper.attributes.url,rotation:e.PhotoModelHelper.attributes.rotation,isMarketplaceLicensable:e.PhotoModelHelper.attributes.isMarketplaceLicensable,marketplaceLicensingUrl:e.PhotoModelHelper.attributes.marketplaceLicensingUrl,oWidth:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},oHeight:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},hasInvalidColorspaceForPrint:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMarketplacePrintable:{defaultFn:function(e){return!1}}}})},"@VERSION@",{requires:["flickr-model-registry","photo-model-helper","person-model-helper","flickr-favorites-add-updater","flickr-favorites-remove-updater","photo-models","photo-engagement-models","person-models"]});
YUI.add("flickr-explore-getContext-fetcher",function(e,t){"use strict";function n(t){var n={photo_id:t.photoId,extras:e.APIHelper.request.getRebootPhotoExtras(),num_prev:t.numPrev,num_next:t.numNext};return n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=t[6],l=[],c=[],h=s.proxy(n.photoId),p,d,v,m,g,y,b=[];return p=r.nextphotos,d=r.prevphotos,c=e.APIHelper.response.parsePhotos({photos:p.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),l=e.APIHelper.response.parsePhotos({photos:d.photo,personModelRegistry:o,photoModelRegistry:s,photoEngagementModelRegistry:u,photoStatsModelRegistry:a,photoCurationModelRegistry:f}),y=i.getValue(n.id,"photoContextList"),m=y.hasMinBoundary?y.hasMinBoundary():!1,g=y.hasMaxBoundary?y.hasMaxBoundary():!1,v=y.getList(),b=e.APIHelper.response.addOrReplaceListByContext({model:h,next:c,prev:l.reverse(),current:v,hasMin:m,hasMax:g,numNext:n.numNext,numPrev:n.numPrev}),i.setValue(n.id,"photoContextList",b),{next:c,previous:l.reverse()}}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.explore.getContext",this._processParams(n),!0),r.getModelRegistry("explore-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models"),r.getModelRegistry("photo-curation-models")]).then(function(e){return i._processResponse(e,n)},function(e){throw e.code===1&&e.message==="Photo not in explore"&&(e.notInContext=!0),e}).then(null,e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-explore-getContext"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["explore-models","photo-models","photo-engagement-models","photo-stats-models","photo-curation-models"]});
YUI.add("explore-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,langBundles:this.details.langBundles,remote:{read:function(t){return e.ListFetchers["flickr-interestingness-getList"].run(t,this.appContext)}},attributes:{photos:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-interestingness-getList"]}},totalItems:{defaultValue:0,setter:function(t){return t=e.AttributeHelpers.coerceInteger(t),t<0&&(t=0),t}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-explore-getContext"],listItemIdField:"photoId"}},displayType:{readOnly:!0,defaultValue:"explore"},url:{readOnly:!0,defaultFn:function(e){return"/explore/"+e.replace(/-/g,"/")}},urlSuffix:{readOnly:!0,defaultFn:function(e){return"explore-"+e}},title:{readOnly:!0,defaultFn:function(e){return this.intlMessage({intlName:"models.EXPLORE_TITLE",id:e})}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-interestingness-getList-fetcher","flickr-explore-getContext-fetcher"],langBundles:["models"]});
YUI.add("flickr-interestingness-getList-fetcher",function(e,t){function r(t,r){var i,s;return i={extras:e.APIHelper.request.getRebootPhotoLiteExtras(),per_page:t.perPage||n,page:t.page||"1",date:t.id},s=e.merge(i,t.apiParams||{}),s}function i(t,n){var r=t[0],i=t[1],s=t[2],o={id:n.id},u=[],a;if(!n.id)throw new ReferenceError("No `id` provided by request.");if(!r.photos||!r.photos.photo)throw new Error("No `photos.photo` property returned by API.");return u=r.photos.photo.map(function(t){return a=e.APIHelper.response.parsePhotoLite(t),s.addOrUpdate(a)}),o.photos={perPage:r.photos.perpage,page:r.photos.page||1,pageContent:u,totalItems:r.photos.total,totalPages:r.photos.pages},o.totalItems=r.photos.total,i.addOrUpdate(o),o.photos.pageContent}function s(n,r){var i=this,s=this._processParams(n,r),o;return o=[r.callAPI("flickr.interestingness.getList",s),r.getModelRegistry("explore-models"),r.getModelRegistry("photo-lite-models")],e.Promise.all(o).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}var n=100;e.namespace("ListFetchers")["flickr-interestingness-getList"]={run:s,_processParams:r,_processResponse:i}},"@VERSION@",{requires:["api-helper","flickr-promise"],optional:["explore-models","photo-lite-models"]});
YUI.add("explore-route",function(e,t){function s(e){s.superclass.constructor.call(this,e)}var n=50,r=1,i=4;e.Routes[this.name]=s,e.extend(s,e.FlickrRoute,{langBundles:this.details.langBundles,run:function(t){var s={},o,u,a,f=t.query||{},l=f.layout||"justified",c=t.params||{},h=c.photo_id,p=this;return t.params.year?u=[t.params.year.toString(),t.params.month.toString(),t.params.day.toString()]:(o=e.moment.utc().subtract({days:r,hours:i}),u=[o.format("YYYY"),o.format("MM"),o.format("DD")]),s.id=u.join("-"),s.apiParams={date:s.id},a={perPage:n,withPhotoId:h},this.appContext.getModel("explore-models",s,a).then(function(t){return e.Promise.resolve({view:"explore-page-view",params:{exploreId:t.id,photoListLayoutStyle:l,withPhotoId:h},title:p.intlMessage({intlName:"common.EXPLORE"}),layout:"scrolling"})},function(t){return e.Promise.resolve({view:"explore-page-view",params:{failed:!0},title:p.intlMessage({intlName:"common.EXPLORE"}),layout:"scrolling"})})}}),e.mix(s.prototype,e.Localizable)},"@VERSION@",{requires:["flickr-route","flickr-promise","explore-models","moment"],langBundles:["common"]});
